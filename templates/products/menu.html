{% extends 'base.html' %}
{% block content %}
{% load static %}

<link rel="stylesheet" type="text/css" href="{% static 'css/menu.css' %}" />

<div class="title">The Lair Menu</div>

<div class="search-filter-container">
  <form class="search-form" method="get" action="{% url 'menu' %}">
    <input type="text" name="search" placeholder="Search..." value="{{ request.GET.search }}">
    <button type="submit" id="search-button">Search</button>
    <button class="buttonStyle"  type="button" id="clear-button" style="display: none;">X</button>
  </form>

  <form method="get">
    <label for="type">Filter by type:</label>
    <select id="type" name="type">
        <option value="">All</option>
        <option value="pizza" {% if request.GET.type == "pizza" %}selected{% endif %}>Pizzas</option>
        <option value="side" {% if request.GET.type == "side" %}selected{% endif %}>Sides</option>
        <option value="drink" {% if request.GET.type == "drink" %}selected{% endif %}>Drinks</option>
    </select>
    <button type="submit">Apply</button>
  </form>
</div>

<!-- All the pizza products -->
{% if pizzas %}
  <div class="subtitle">Pizzas</div>
  <div class="products-container">
    {% for pizza in pizzas %}
      {% if pizza.type == 'pizza' %}
      <div class="Pizza products">
        <p class="name text">{{ pizza.name }}</p>
        <p class="description text">{{ pizza.description }}</p>
        <span class="text">
          Small 1.500kr <br>
          Medium 3.500kr <br>
          Large 4.500kr
        </span>

        <form  action="{% url 'menuItem' %}" method="get">
          <input type="hidden" name="id" value="{{ pizza.id }}">
          <button class="buttonStyle" type="submit">Details</button>
        </form>
      </div>
      {% endif %}
    {% endfor %}
  </div>
{% endif %}

<!-- All the sides products -->
{% if sides %}
  <div class="subtitle">Sides</div>
  <div class="products-container">
    {% for side in sides %}
      {% if side.type == 'side' %}
      <div class="Side products">
        <p class="name text">{{ side.name }}</p>
        <p class="description text">{{ side.description }}</p>
        <span class="text">{{ side.price }} kr</span>

        <form  action="{% url 'menuItem' %}" method="get">
          <input type="hidden" name="id" value="{{ side.id }}">
          <button class="buttonStyle" type="submit">Details</button>
        </form>
      </div>
      {% endif %}
    {% endfor %}
  </div>
{% endif %}

<!-- All the drinks products -->
{% if drinks %}
  <div class="subtitle">Drinks</div>
  <div class="products-container">
    {% for drink in drinks %}
      {% if drink.type == 'drink' %}
      <div class="Drink products">
        <p class="name text">{{ drink.name }}</p>
        <p class="description text">{{ drink.description }}</p>
        <span class="text">{{ drink.price }} kr</span>

        <form  action="{% url 'menuItem' %}" method="get">
          <input type="hidden" name="id" value="{{ drink.id }}">
          <button class="buttonStyle" type="submit">Details</button>
        </form>
      </div>
      {% endif %}
    {% endfor %}
  </div>
{% endif %}

<script>
  const searchInput = document.querySelector('input[name="search"]');
  const searchButton = document.getElementById('search-button');
  const clearButton = document.getElementById('clear-button');

  searchInput.addEventListener('input', () => {
    if (searchInput.value.trim().length > 0) {
      clearButton.style.display = 'block';
    } else {
      clearButton.style.display = 'none';
    }
  });

</script>

{% endblock %}
